import pandas as pd

score_type = 'SCORE'
dfagg = df[df[score_type] == df['BEST_' + score_type]]

rows = []
for seg in segments:
    cat = segment_map[seg]
    sub = dfagg[dfagg['LOANPURPOSECATEGORY'] == cat]
    pos_mean = sub.loc[sub['target'] == 1, score_type].mean()
    neg_mean = sub.loc[sub['target'] == 0, score_type].mean()
    rows.append({'segment': seg, 'pos_mean': pos_mean, 'neg_mean': neg_mean})

res = pd.DataFrame(rows)
print(res)

high = res.loc[res['pos_mean'].idxmax()]
low  = res.loc[res['pos_mean'].idxmin()]

print("\nExample:")
print(f"Segment {high['segment']} — positives mean {high['pos_mean']:.3f}, negatives mean {high['neg_mean']:.3f}")
print(f"Segment {low['segment']}  — positives mean {low['pos_mean']:.3f}, negatives mean {low['neg_mean']:.3f}")

print("\nComparing these means across segments is like comparing apples to oranges and does not reflect true within-segment performance.")
