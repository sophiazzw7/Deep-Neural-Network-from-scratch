/* STEP 1: Sort data by score descending (highest score = best) */
proc sort data=sc_sec_scored_CIDS_V4 out=ks_sorted;
   by descending pts_ttl;
run;

/* STEP 2: Summarize total bad and good weights */
proc sql noprint;
   select sum(wt*(bad60_24m=1)) into :total_bad from ks_sorted;
   select sum(wt*(bad60_24m=0)) into :total_good from ks_sorted;
quit;

/* STEP 3: Calculate cumulative good/bad */
data ks_curve;
   set ks_sorted;
   retain cum_good cum_bad 0;
   if bad60_24m = 1 then cum_bad  + wt;
   else                 cum_good + wt;

   pct_cum_bad  = cum_bad  / &total_bad;
   pct_cum_good = cum_good / &total_good;

   ks_val = abs(pct_cum_bad - pct_cum_good);
run;

/* STEP*
